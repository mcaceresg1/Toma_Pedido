<div class="pb-12 px-4 md:px-4 bg-neutral-100 w-full h-full overflow-x-hidden overflow-y-auto">

  <div class="flex flex-col md:flex-row my-4 bg-white rounded-md shadow overflow-hidden">
    <mat-toolbar class="!w-fit !bg-white">
      <span>Reporte de Productos</span>
    </mat-toolbar>
  </div>

  <div class="mt-3 flex flex-col gap-3 bg-white rounded-md shadow overflow-hidden px-2 py-4 md:p-4">
    <!-- <div class="flex items-center justify-between mb-3 text-sm">
      <div>
        Mostrar
        <select [(ngModel)]="itemsPerPage" class="border rounded px-2 py-1 mx-1">
          <option [ngValue]="6">6</option>
          <option [ngValue]="10">10</option>
          <option [ngValue]="25">25</option>
          <option [ngValue]="50">50</option>
        </select>
        producto por p√°gina
      </div>
      <div>
        Buscar:
        <input
          type="text"
          [(ngModel)]="searchTerm"
          placeholder=""
          class="border rounded px-2 py-1"
        />
      </div>
    </div> -->
    <div
      class="px-6 py-4 grid gap-3 md:flex md:justify-between md:items-center border-b border-gray-200 dark:border-neutral-700">
      <!-- Input -->
      <div class="w-full sm:max-w-[400px] min-w-[300px]">
        <label for="hs-as-table-product-review-search" class="sr-only">Search</label>
        <div class="relative">
          <input type="text" id="hs-as-table-product-review-search" name="hs-as-table-product-review-search"
            [(ngModel)]="searchTerm" (ngModelChange)="onSearch($event)"
            class="py-2 px-3 ps-11 block w-full border-gray-200 rounded-lg text-sm focus:border-blue-500 focus:ring-blue-500 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-400 dark:placeholder-neutral-500 dark:focus:ring-neutral-600"
            placeholder="Buscar por C√≥digo, SKU o Descripci√≥n" />
          <div class="absolute inset-y-0 start-0 flex items-center pointer-events-none ps-4">
            <svg class="size-4 text-gray-400 dark:text-neutral-500" xmlns="http://www.w3.org/2000/svg" width="16"
              height="16" fill="currentColor" viewBox="0 0 16 16">
              <path
                d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z" />
            </svg>
          </div>
        </div>
      </div>

      <!-- End Input -->

      <div class="sm:col-span-2 md:grow">
        <div class="flex justify-end gap-x-2">
          <button mat-button [matMenuTriggerFor]="menu"
            class="inline-flex justify-center px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
            Exportar
            <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
            </svg>
          </button>

          <mat-menu #menu="matMenu" class="bg-white border border-gray-200 rounded-md shadow-lg p-1">
            <button mat-menu-item (click)="exportProductosToPDF()" class="text-gray-700 hover:bg-gray-100">
              Exportar a PDF
            </button>

            <button mat-menu-item (click)="exportarProductosExcel()" class="text-gray-700 hover:bg-gray-100">
              Exportar a Excel
            </button>
            <!-- <button mat-menu-item (click)="exportToCSV()" class="text-gray-700 hover:bg-gray-100">
                Exportar a CSV
              </button> -->

          </mat-menu>

        </div>
      </div>

    </div>

    <div class="overflow-x-auto border rounded shadow h-[calc(100vh-200px)]">
      <table class="text-sm text-left text-gray-800 w-full table-auto">
        <thead class="bg-gray-100 text-xs uppercase text-gray-600">
          <tr>
            <th (click)="toggleOrder('descripcion')" class="px-3 py-3 cursor-pointer min-w-[90px] whitespace-nowrap">
              C√≥digo
              <span *ngIf="order === 'descripcion'">{{ reverse ? 'üîΩ' : 'üîº' }}</span>
            </th>

            <th (click)="toggleOrder('descripcion')"
              class="px-3 py-2 whitespace-nowrap w-auto min-w-[400px] cursor-pointer">
              Descripci√≥n
              <span *ngIf="order === 'descripcion'">{{ reverse ? 'üîΩ' : 'üîº' }}</span>
            </th>
            <th class="px-3 py-2">Clase</th>
            <th class="px-3 py-2">Marca</th>
            <th class="px-3 py-2">UDM</th>
            <th class="px-3 py-2">Departamento</th>
            <th class="px-3 py-2">Versi√≥n</th>
            <th class="px-3 py-2">Tipo Mercader√≠a</th>
            <th (click)="toggleOrder('descripcion')" class="px-3 py-2 cursor-pointer">
              SKU
              <span *ngIf="order === 'descripcion'">{{ reverse ? 'üîΩ' : 'üîº' }}</span>
            </th>
            <th class="px-3 py-2">Empaque</th>
            <th class="px-3 py-2">Peso</th>
            <th class="px-3 py-2">% Comisi√≥n</th>
            <th class="px-3 py-2">Ubicaci√≥n</th>
            <th class="px-3 py-2">SUNAT</th>
            <th class="px-3 py-2">Costo Compra</th>
            <th class="px-3 py-2">Soles</th>
            <th class="px-3 py-2">Existencia</th>
            <th class="px-3 py-2">Costo Prom.</th>
            <th class="px-3 py-2">√ölt. Compra</th>
            <th class="px-3 py-2">Costo $</th>
            <th class="px-3 py-2">IGV</th>
            <th class="px-3 py-2">Stock Max</th>
            <th class="px-3 py-2">Stock Min</th>
            <th class="px-3 py-2">√ölt. Inventario</th>
            <th class="px-3 py-2">Tipo Existencia</th>
            <th class="px-3 py-2">Unitario</th>
            <th class="px-3 py-2">Cat. B</th>
            <th class="px-3 py-2">Cat. A</th>
            <th class="px-3 py-2">Personalizado</th>
            <th class="px-3 py-2">Disponible</th>
            <th class="px-3 py-2">Estado</th>
          </tr>
        </thead>
        <tbody class="divide-y">
          <tr *ngFor="let item of paginatedItems.data">
            <td (click)="abrirDetalle(item)"
              class="text-blue-600 cursor-pointer hover:underline px-3 py-2 whitespace-nowrap text-sm font-medium">
              {{ item.codigo }}
            </td>
            <td class="px-3 py-1 whitespace-nowrap w-auto min-w-[400px]">{{ item.descripcion }}</td>
            <td class="px-3 py-1 whitespace-nowrap">{{ item.descripcionClase }}</td>
            <td class="px-3 py-1 whitespace-nowrap">{{ item.descripcionMarca }}</td>
            <td class="px-3 py-1 whitespace-nowrap">{{ item.descripcionUDM }}</td>
            <td class="px-3 py-1 whitespace-nowrap">{{ item.descripcionDepartamento }}</td>
            <td class="px-3 py-1 whitespace-nowrap">{{ item.desctipcionVersion }}</td>
            <td class="px-3 py-1 whitespace-nowrap">{{ item.descripcionTipoMercaderia }}</td>
            <td class="px-3 py-1 whitespace-nowrap">{{ item.codigo_de_Barra_SKU }}</td>
            <td class="px-3 py-1 whitespace-nowrap">{{ item.empaque }}</td>
            <td class="px-3 py-1 whitespace-nowrap">{{ item.peso_Unitario }}</td>
            <td class="px-3 py-1 whitespace-nowrap">{{ item.porc_Comision }}</td>
            <td class="px-3 py-1 whitespace-nowrap">{{ item.ubicacion }}</td>
            <td class="px-3 py-1 whitespace-nowrap">{{ item.codigo_Sunat }}</td>
            <td class="px-3 py-1 whitespace-nowrap">{{ item.costo_de_Compra | currency:'PEN' }}</td>
            <td class="px-3 py-1 whitespace-nowrap">{{ item.soles | currency:'PEN' }}</td>
            <td class="px-3 py-1 whitespace-nowrap">{{ item.existencia }}</td>
            <td class="px-3 py-1 whitespace-nowrap">{{ item.costo_Promedio | number:'1.2-2' }}</td>
            <td class="px-3 py-1 whitespace-nowrap">{{ item.ultima_Compra | number:'1.2-2' }}</td>
            <td class="px-3 py-1 whitespace-nowrap">{{ item.costo_Dolar | currency:'USD' }}</td>
            <td class="px-3 py-1 whitespace-nowrap">{{ item.tipo_IGV }}%</td>
            <td class="px-3 py-1 whitespace-nowrap">{{ item.stock_Maximo }}</td>
            <td class="px-3 py-1 whitespace-nowrap">{{ item.sock_Minimo }}</td>
            <td class="px-3 py-1 whitespace-nowrap">{{ item.ultimo_Inventario | date:'shortDate' }}</td>
            <td class="px-3 py-1 whitespace-nowrap">{{ item.tipo_Existencia }}</td>
            <td class="px-3 py-1 whitespace-nowrap">{{ item.unitario | currency:'PEN' }}</td>
            <td class="px-3 py-1 whitespace-nowrap">{{ item.cat_B | currency:'PEN' }}</td>
            <td class="px-3 py-1 whitespace-nowrap">{{ item.cat_A | currency:'PEN' }}</td>
            <td class="px-3 py-1 whitespace-nowrap">{{ item.personalizado }}</td>
            <td class="px-3 py-1 whitespace-nowrap">{{ item.disponible }}</td>
            <td class="px-3 py-1 whitespace-nowrap">{{ item.estado }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- End Table -->
    <div
      class="px-6 py-4 grid gap-3 md:flex md:justify-between md:items-center border-t border-gray-200 dark:border-neutral-700">
      <div class="max-w-sm space-y-3">
        <select select [(ngModel)]="itemsPerPage"
          class="py-2 px-3 pe-9 block w-full border-gray-200 rounded-lg text-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-400">
          <option [ngValue]="10">10</option>
          <option [ngValue]="25">25</option>
          <option [ngValue]="50">50</option>
          <option [ngValue]="75">75</option>
          <option [ngValue]="100">100</option>
        </select>
      </div>

      <!-- <div>
            <div class="inline-flex gap-x-2">
              <button type="button" class="py-2 px-3 inline-flex items-center gap-x-2 text-sm font-medium rounded-lg border border-gray-200 bg-white text-gray-800 shadow-2xs hover:bg-gray-50 focus:outline-hidden focus:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-800 dark:border-neutral-700 dark:text-white dark:hover:bg-neutral-700 dark:focus:bg-neutral-700">
                <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>
                Prev
              </button>

              <button type="button" class="py-2 px-3 inline-flex items-center gap-x-2 text-sm font-medium rounded-lg border border-gray-200 bg-white text-gray-800 shadow-2xs hover:bg-gray-50 focus:outline-hidden focus:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-800 dark:border-neutral-700 dark:text-white dark:hover:bg-neutral-700 dark:focus:bg-neutral-700">
                Next
                <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"/></svg>
              </button>
            </div>
          </div> -->
      <div class="mt-4 flex justify-between items-center">
        <button (click)="changePage(page - 1)" [disabled]="page <= 1" class="px-3 py-1 bg-gray-200 rounded">
          ‚Üê Prev
        </button>

        <span>
          P√°gina {{ paginatedItems.currentPage }} de {{ paginatedItems.totalPages }}
        </span>

        <button (click)="changePage(page + 1)" [disabled]="page >= paginatedItems.totalPages"
          class="px-3 py-1 bg-gray-200 rounded">
          Next ‚Üí
        </button>
      </div>

    </div>
    <!-- End Footer -->
  </div>
</div>

<!-- Modal -->
<div *ngIf="modalAbierto" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50">
  <div class="bg-white rounded-lg shadow-lg w-full max-w-md p-6 relative">
    <button (click)="cerrarModal()" class="absolute top-2 right-2 text-gray-500 hover:text-gray-700">
      ‚úï
    </button>

    <h2 class="text-lg font-semibold mb-4">Detalle del Producto</h2>

    <div *ngIf="productoSeleccionado">
      <p><strong>ID:</strong> {{ productoSeleccionado.codigo }}</p>
      <p><strong>Descripci√≥n:</strong> {{ productoSeleccionado.descripcion }}</p>
      <p><strong>Clase:</strong> {{ productoSeleccionado.descripcionClase }}</p>
      <p><strong>Marca:</strong> {{ productoSeleccionado.descripcionMarca }}</p>
      <p><strong>Unidad de medida:</strong> {{ productoSeleccionado.descripcionUDM }}</p>
      <p><strong>Departamento:</strong> {{ productoSeleccionado.descripcionDepartamento }}</p>
      <p><strong>Versi√≥n:</strong> {{ productoSeleccionado.desctipcionVersion }}</p>
      <p><strong>Tipo Mercader√≠a:</strong> {{ productoSeleccionado.descripcionTipoMercaderia }}</p>
      <p><strong>SKU:</strong> {{ productoSeleccionado.codigo_de_Barra_SKU }}</p>
      <p><strong>Empaque:</strong> {{ productoSeleccionado.empaque }}</p>
      <p><strong>Peso:</strong> {{ productoSeleccionado.peso_Unitario }}</p>
      <p><strong>% Comisi√≥n:</strong> {{ productoSeleccionado.porc_Comision }}</p>
      <p><strong>Ubicaci√≥n:</strong> {{ productoSeleccionado.ubicacion }}</p>
      <p><strong>SUNAT:</strong> {{ productoSeleccionado.codigo_Sunat }}</p>
      <p><strong>Costo Compra:</strong> {{ productoSeleccionado.costo_de_Compra }}</p>
      <p><strong>Soles:</strong> {{ productoSeleccionado.soles }}</p>
      <p><strong>Existencia:</strong> {{ productoSeleccionado.existencia }}</p>
      <p><strong>Costo Promedio:</strong> {{ productoSeleccionado.costo_Promedio }}</p>
      <p><strong>√ölt. Compra:</strong> {{ productoSeleccionado.ultima_Compra }}</p>
      <p><strong>Costo $:</strong> {{ productoSeleccionado.costo_Dolar }}</p>
      <p><strong>IGV:</strong> {{ productoSeleccionado.tipo_IGV }}</p>
      <p><strong>Stock M√°ximo:</strong> {{ productoSeleccionado.stock_Maximo }}</p>
      <p><strong>Stock M√≠nimo:</strong> {{ productoSeleccionado.sock_Minimo }}</p>
      <p><strong>√ölt. Inventario:</strong> {{ productoSeleccionado.ultimo_Inventario }}</p>
      <p><strong>Tipo Existencia:</strong> {{ productoSeleccionado.tipo_Existencia }}</p>
      <p><strong>Unitario:</strong> {{ productoSeleccionado.unitario }}</p>
      <p><strong>Cat. B:</strong> {{ productoSeleccionado.cat_B }}</p>
      <p><strong>Cat. A:</strong> {{ productoSeleccionado.cat_A }}</p>
      <p><strong>Personalizado:</strong> {{ productoSeleccionado.personalizado }}</p>
      <p><strong>Disponible:</strong> {{ productoSeleccionado.disponible }}</p>
      <p><strong>Disponible:</strong> {{ productoSeleccionado.estado }}</p>
      <!-- Agrega m√°s campos si es necesario -->
    </div>
  </div>
</div>